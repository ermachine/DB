-- Создание таблиц
CREATE TABLE IF NOT EXISTS phystech_school (
    phystech_school_name        VARCHAR(128)    PRIMARY KEY,
    manager_name                VARCHAR(128)    NOT NULL,
    foundation_dt               VARCHAR(128)    NOT NULL
);

CREATE TABLE IF NOT EXISTS department (
    department_name             VARCHAR(128)    PRIMARY KEY,
    location_auditorium_id      VARCHAR(128)    NOT NULL
);

CREATE TABLE IF NOT EXISTS employee (
    employee_name               VARCHAR(128)    PRIMARY KEY,
    position                    VARCHAR(128)    NOT NULL,
    birthday_dt                 DATE,
    department_name             VARCHAR(128),
    wikimipt_link_url           VARCHAR(128),
    FOREIGN KEY (department_name) REFERENCES department(department_name)
);

CREATE TABLE IF NOT EXISTS employee_history (
    id                          SERIAL PRIMARY KEY,
    employee_name               VARCHAR(128)       NOT NULL,
    position                    VARCHAR(128),
    birthday_dt                 DATE,
    department_name             VARCHAR(128),
    wikimipt_link_url           VARCHAR(128),
    date_from                   DATE NOT NULL,
    date_to                     DATE,
    FOREIGN KEY (employee_name) REFERENCES employee(employee_name),
    FOREIGN KEY (department_name) REFERENCES department(department_name)
);

CREATE TABLE IF NOT EXISTS course (
    course_id                   SERIAL PRIMARY KEY,
    course_name                 VARCHAR(128)       NOT NULL,
    department_name             VARCHAR(128),
    FOREIGN KEY (department_name) REFERENCES department(department_name)
);

CREATE TABLE IF NOT EXISTS teacher_course (
    teacher_name                VARCHAR(128),
    course_id                   INT,
    PRIMARY KEY (teacher_name, course_id),
    FOREIGN KEY (teacher_name) REFERENCES employee(employee_name),
    FOREIGN KEY (course_id) REFERENCES course(course_id)
);

CREATE TABLE IF NOT EXISTS student (
    student_name                VARCHAR(128)    PRIMARY KEY,
    birthday_dt                 DATE,
    group_id                    VARCHAR(32)     NOT NULL,
    department_name             VARCHAR(128),
    admission_dt                DATE,
    average_mark                DECIMAL(3,2),
    -- будем считать в данной моделе балл фиксированным
    scholarship                 DECIMAL(8,2),
    fee                         DECIMAL(8,2),
    FOREIGN KEY (department_name) REFERENCES department(department_name)
);

CREATE TABLE IF NOT EXISTS group_table (
    group_id                    VARCHAR(32)        PRIMARY KEY,
    phystech_school             VARCHAR(32)        NOT NULL,
    head_student_name           VARCHAR(128)       NOT NULL,
    group_size                  INT                NOT NULL,
    FOREIGN KEY (phystech_school) REFERENCES phystech_school(phystech_school_name),
    FOREIGN KEY (head_student_name) REFERENCES student(student_name)
);

CREATE TABLE IF NOT EXISTS auditorium (
    auditorium_id       SERIAL  PRIMARY KEY,
    auditorium_number   VARCHAR(32)         NOT NULL,
    floor               INT                 NOT NULL,
    building            VARCHAR(32)         NOT NULL,
    auditorium_size     VARCHAR(21)  -- большая, средняя или маленькая
);

CREATE TABLE IF NOT EXISTS schedule (
    id                  SERIAL PRIMARY KEY,
    start_dttm          DATE               NOT NULL,
    end_dttm            DATE               NOT NULL,
    course_id           INT                NOT NULL,
    teacher_name        VARCHAR(128)       NOT NULL,
    default_group_id    VARCHAR(32)        NOT NULL,
    auditorium_id       INT                NOT NULL,
    FOREIGN KEY (course_id) REFERENCES course(course_id),
    FOREIGN KEY (teacher_name) REFERENCES employee(employee_name),
    FOREIGN KEY (default_group_id) REFERENCES group_table(group_id),
    FOREIGN KEY (auditorium_id) REFERENCES auditorium(auditorium_id)
);



-- Заполнение таблиц
INSERT INTO phystech_school
    (phystech_school_name, manager_name, foundation_dt)
VALUES
    ('ФПМИ', 'Райгородский Андрей Михайлович', '2016-09-01'),
    ('ЛФИ', 'Рогачёв Андрей Вячеславович', '2016-09-01')
;


INSERT INTO department
    (department_name, location_auditorium_id)
VALUES
    ('Кафедра ДМ', 1),
    ('Кафедра высшей математики', 2),
    ('Кафедра МОУ', 5),
    ('Кафедра АТП', 10)
;


INSERT INTO employee
    (employee_name, position, birthday_dt, department_name, wikimipt_link_url)
VALUES
    ('Никитин Родион Сергеевич', 'Профессор', '1975-03-22', 'Кафедра ДМ', 'https://wiki.mipt.tech/index.php/Андрейчиков Родион Сергеевич'),
    ('Васюк Вадим Александрович', 'Доцент', '1980-10-15', 'Кафедра высшей математики', 'https://wiki.mipt.tech/index.php/Николаев Вадим Александрович'),
    ('Владимирова Ольга Олеговна', 'Уборщица', '1969-07-30', Null, Null),
    ('Максимов Михаил Евгеньевич', 'Лектор', '2003-12-16', 'Кафедра МОУ', 'http://wiki/Максимов Михаил Евгеньевич'),
    ('Павлов Марат Манасович', 'Профессор', '1965-08-11', 'Кафедра АТП', Null),
    ('Никитина Анна Павловна', 'Кандидат физико-математических наук', '1996-08-11', 'Кафедра АТП', Null)
;


INSERT INTO employee_history
    (employee_name, position, birthday_dt, department_name, wikimipt_link_url, date_from, date_to)
VALUES
    ('Владимирова Ольга Олеговна', 'Лектор', '1969-07-30', Null, Null, '2023-01-01', '2023-06-01'),
    ('Павлов Марат Манасович', 'Повар', '1965-08-11',  Null, Null, '2023-01-01', '2024-01-01'),
    ('Павлов Марат Манасович', 'Доцент', '1965-08-11', 'Кафедра МОУ', Null, '2024-01-01', '2025-01-01')
;


INSERT INTO course
    (course_name, department_name)
VALUES
    ('Теория вероятности', 'Кафедра высшей математики'),
    ('Функциональный анализ', 'Кафедра высшей математики'),
    ('Теория вероятности', 'Кафедра ДМ'),
    ('Алгоритмы и структуры данных', 'Кафедра АТП'),
    ('Теория вероятности', 'Кафедра МОУ'),
    ('Базы данных', 'Кафедра АТП')
;


INSERT INTO teacher_course
    (teacher_name, course_id)
VALUES
    ('Никитин Родион Сергеевич', 3),
    ('Никитин Родион Сергеевич', 2),
    ('Васюк Вадим Александрович', 1),
    ('Васюк Вадим Александрович', 6),
    ('Васюк Вадим Александрович', 5),
    ('Максимов Михаил Евгеньевич', 1),
    ('Максимов Михаил Евгеньевич', 2),
    ('Максимов Михаил Евгеньевич', 4),
    ('Максимов Михаил Евгеньевич', 6),
    ('Максимов Михаил Евгеньевич', 5),
    ('Павлов Марат Манасович', 5),
    ('Павлов Марат Манасович', 6)
;


INSERT INTO student
    (student_name, birthday_dt, group_id, department_name, admission_dt, average_mark, scholarship, fee)
VALUES
    ('Кузнецов Илья Муромец', '2002-06-12', 'Б05-001', Null, '2023-09-01', 7.8, 5000.00, 0.00),
    ('Козлов Илья Муромец', '2002-05-11', 'Б05-001', 'Кафедра МОУ', '2020-09-01', 8.9, 5000.00, 200000.00),
    ('Коровин Илья Муромец', '2002-04-11', 'Б05-001', Null, '2020-09-01', 7.9, 5000.00, 0.00),
    ('Комаров Илья Муромец', '2002-05-05', 'Б05-001', Null, '2020-09-01', 3.0, 0.00, 0.00),
    ('Кабанов Илья Муромец', '2002-04-10', 'Б05-001', Null, '2020-09-01', 9.7, 45000.00, 0.00),
    ('Курицын Илья Муромец', '2002-03-21', 'Б05-001', Null, '2020-09-01', 6.9, 5000.00, 0.00),
    ('Карасев Илья Муромец', '2002-01-09', 'Б05-001', Null, '2020-09-01', 4.7, 0.00, 0.00),

    ('Воронин Добрыня Никитич', '2002-06-12', 'Б05-002', Null, '2020-09-01', 7.7, 5000.00, 0.00),
    ('Воронов Добрыня Никитич', '2002-05-11', 'Б05-002', Null, '2020-09-01', 8.7, 5000.00, 0.00),
    ('Воронков Добрыня Никитич', '2002-04-11', 'Б05-002', 'Кафедра ДМ', '2022-09-01', 7.6, 5000.00, 0.00),
    ('Воров Добрыня Никитич', '2002-05-05', 'Б05-002', Null, '2020-09-01', 3.6, 0.00, 0.00),
    ('Воронихин Добрыня Никитич', '2002-04-10', 'Б05-002', Null, '2021-09-01', 9.0, 5000.00, 0.00),
    ('Ворончихин Добрыня Никитич', '2002-03-21', 'Б05-002', Null, '2020-09-01', 6.5, 5000.00, 0.00),

    ('Шаман Алеша Попович', '2001-06-12', 'Б05-003', Null, '2020-09-01', 7.0, 0.00, 0.00),
    ('Лепс Алеша Попович', '2001-05-11', 'Б05-003', Null, '2020-09-01', 7.0, 0.00, 0.00),
    ('Михайлов Алеша Попович', '2001-04-11', 'Б05-003', Null, '2020-09-01', 7.0, 0.00, 0.00),
    ('Билан Алеша Попович', '2003-05-05', 'Б05-003', Null, '2020-09-01', 7.0, 0.00, 0.00),

    ('Баранова Мария Петровна', '2001-07-18', 'Б05-004', 'Кафедра АТП', '2020-09-01', 4.2, 7000.00, 0.00),
    ('Овечкина Мария Петровна', '2003-02-22', 'Б05-004', Null, '2021-09-01', 5.0, 12000.00, 0.00),
    ('Собакевич Мария Петровна', '2002-03-14', 'Б05-004', Null, '2020-09-01', 3.6, 3500.00, 500000.00),
    
    ('Петров Игорь Викторович', '2000-12-05', 'Б05-005', Null, '2021-09-01', 4.8, 0.00, 0.00),
    ('Иванов Игорь Викторович', '2002-08-23', 'Б05-005', Null, '2020-09-01', 3.9, 4500.00, 150000.00),
    ('Сидоров Игорь Викторович', '2001-11-01', 'Б05-005', Null, '2019-09-01', 4.1, 9500.00, 0.00),
    
    ('Орлов Дмитрий Петрович', '2002-05-16', 'Б05-006', Null, '2020-09-01', 3.5, 7500.00, 200000.00),
    ('Васильева Ольга Николаевна', '2001-09-14', 'Б05-006', Null, '2021-09-01', 4.6, 11000.00, 0.00),
    ('Федорова Марина Владимировна', '2000-06-20', 'Б05-006', Null, '2020-09-01', 4.0, 10500.00, 0.00),
    
    ('Жуков Петр Сергеевич', '2000-04-12', 'Б05-007', Null, '2018-09-01', 4.9, 15000.00, 0.00),
    ('Комаров Петр Сергеевич', '2001-08-18', 'Б05-007', 'Кафедра ДМ', '2019-09-01', 3.8, 6000.00, 250000.00),
    
    ('Тупица Владислав Юрьевич', '2002-01-03', 'Б05-008', Null, '2020-09-01', 2.9, 0.00, 0.00),
    ('Тупица Вера Андреевна', '2001-12-28', 'Б05-008', Null, '2021-09-01', 3.0, 0.00, 0.00)
;


INSERT INTO group_table
    (group_id, phystech_school, head_student_name, group_size)
VALUES
    ('Б05-001', 'ФПМИ', 'Коровин Илья Муромец', 7),
    ('Б05-002', 'ФПМИ', 'Воронин Добрыня Никитич', 6),
    ('Б05-003', 'ФПМИ', 'Шаман Алеша Попович', 4),
    ('Б05-004', 'ФПМИ', 'Баранова Мария Петровна', 3),
    ('Б05-005', 'ФПМИ', 'Иванов Игорь Викторович', 3),
    ('Б05-006', 'ФПМИ', 'Орлов Дмитрий Петрович', 3),
    ('Б05-007', 'ФПМИ', 'Комаров Петр Сергеевич', 2),
    ('Б05-008', 'ФПМИ', 'Тупица Владислав Юрьевич', 2)
;


INSERT INTO auditorium
    (auditorium_number, floor, building, auditorium_size)
VALUES
    ('403', 4, 'КПМ', 'Маленькая'),
    ('437', 4, 'ГК', 'Средняя'),
    ('103', 1, 'ГК', 'Средняя'),
    ('104', 1, 'ЛК', 'Средняя'),
    ('905', 9, 'КПМ', 'Маленькая'),
    ('201', 2, 'ЛК', 'Средняя'),
    ('202', 2, 'БИО', 'Средняя'),
    ('903', 9, 'КПМ', 'Средняя'),
    ('204', 2, 'ГК', 'Средняя'),
    ('307', 3, 'КПМ', 'Маленькая'),
    ('301', 3, 'УЛК-1', 'Большая'),
    ('411', 4, 'ГК', 'Средняя'),
    ('413', 4, 'ГК', 'Средняя'),
    ('415', 4, 'ГК', 'Средняя'),
    ('417', 3, 'ГК', 'Средняя'),
    ('419', 4, 'ГК', 'Средняя'),
    ('402', 4, 'КПМ', 'Большая'),
    ('403', 4, 'ЛК', 'Средняя'),
    ('530', 5, 'ГК', 'Большая'),
    ('524', 5, 'ГК', 'Средняя'),
    ('531', 5, 'ГК', 'Большая');
;


INSERT INTO schedule
    (start_dttm, end_dttm, course_id, teacher_name, default_group_id, auditorium_id)
VALUES
    ('2023-09-01 08:00', '2023-09-01 09:30', 1, 'Васюк Вадим Александрович', 'Б05-001', 11),
    ('2023-09-01 10:00', '2023-09-01 11:30', 2, 'Максимов Михаил Евгеньевич', 'Б05-001', 12),
    ('2023-09-01 12:00', '2023-09-01 13:30', 3, 'Никитин Родион Сергеевич', 'Б05-001', 13),
    ('2023-09-01 14:00', '2023-09-01 15:30', 4, 'Максимов Михаил Евгеньевич', 'Б05-001', 14),
    ('2023-09-02 08:00', '2023-09-02 09:30', 6, 'Васюк Вадим Александрович', 'Б05-001', 15),
    ('2023-09-02 10:00', '2023-09-02 11:30', 5, 'Павлов Марат Манасович', 'Б05-001', 16),
    ('2023-09-02 12:00', '2023-09-02 13:30', 1, 'Максимов Михаил Евгеньевич', 'Б05-002', 11),
    ('2023-09-03 08:00', '2023-09-03 09:30', 2, 'Никитин Родион Сергеевич', 'Б05-002', 12),
    ('2023-09-04 08:00', '2023-09-04 09:30', 3, 'Васюк Вадим Александрович', 'Б05-002', 13),
    ('2023-09-05 08:00', '2023-09-05 09:30', 4, 'Максимов Михаил Евгеньевич', 'Б05-002', 14),
    ('2023-09-05 10:00', '2023-09-05 11:30', 6, 'Васюк Вадим Александрович', 'Б05-002', 15),
    ('2023-09-06 08:00', '2023-09-06 09:30', 5, 'Павлов Марат Манасович', 'Б05-002', 16),
    ('2023-09-07 08:00', '2023-09-07 09:30', 1, 'Максимов Михаил Евгеньевич', 'Б05-003', 11),
    ('2023-09-08 08:00', '2023-09-08 09:30', 2, 'Никитин Родион Сергеевич', 'Б05-003', 12),
    ('2023-09-09 08:00', '2023-09-09 09:30', 3, 'Васюк Вадим Александрович', 'Б05-003', 13),
    ('2023-09-10 08:00', '2023-09-10 09:30', 4, 'Максимов Михаил Евгеньевич', 'Б05-003', 14),
    ('2023-09-10 10:00', '2023-09-10 11:30', 6, 'Васюк Вадим Александрович', 'Б05-003', 15),
    ('2023-09-10 12:00', '2023-09-10 13:30', 5, 'Павлов Марат Манасович', 'Б05-003', 4),
    ('2023-09-11 08:00', '2023-09-11 09:30', 1, 'Максимов Михаил Евгеньевич', 'Б05-004', 11),
    ('2023-09-12 08:00', '2023-09-12 09:30', 2, 'Никитин Родион Сергеевич', 'Б05-004', 12),
    ('2023-09-13 08:00', '2023-09-13 09:30', 3, 'Васюк Вадим Александрович', 'Б05-004', 13),
    ('2023-09-14 08:00', '2023-09-14 09:30', 4, 'Максимов Михаил Евгеньевич', 'Б05-004', 4),
    ('2023-09-14 10:00', '2023-09-14 11:30', 6, 'Васюк Вадим Александрович', 'Б05-004', 15),
    ('2023-09-15 08:00', '2023-09-15 09:30', 5, 'Павлов Марат Манасович', 'Б05-004', 11),
    ('2023-09-15 10:00', '2023-09-15 11:30', 1, 'Максимов Михаил Евгеньевич', 'Б05-005', 1),
    ('2023-09-16 08:00', '2023-09-16 09:30', 2, 'Никитин Родион Сергеевич', 'Б05-005', 12),
    ('2023-09-16 10:00', '2023-09-16 11:30', 3, 'Васюк Вадим Александрович', 'Б05-005', 3),
    ('2023-09-17 08:00', '2023-09-17 09:30', 4, 'Максимов Михаил Евгеньевич', 'Б05-005', 14),
    ('2023-09-18 08:00', '2023-09-18 09:30', 6, 'Васюк Вадим Александрович', 'Б05-005', 15),
    ('2023-09-20 08:00', '2023-09-20 09:30', 5, 'Павлов Марат Манасович', 'Б05-005', 7),
    ('2023-09-21 08:00', '2023-09-21 09:30', 1, 'Максимов Михаил Евгеньевич', 'Б05-006', 11),
    ('2023-09-24 08:00', '2023-09-24 09:30', 2, 'Никитин Родион Сергеевич', 'Б05-006', 12),
    ('2023-09-24 10:00', '2023-09-24 11:30', 3, 'Васюк Вадим Александрович', 'Б05-006', 3),
    ('2023-09-25 08:00', '2023-09-25 09:30', 4, 'Максимов Михаил Евгеньевич', 'Б05-006', 4),
    ('2023-09-25 10:00', '2023-09-25 11:30', 6, 'Васюк Вадим Александрович', 'Б05-006', 15),
    ('2023-09-26 08:00', '2023-09-26 09:30', 5, 'Павлов Марат Манасович', 'Б05-006', 8),
    ('2023-09-27 08:00', '2023-09-27 09:30', 1, 'Максимов Михаил Евгеньевич', 'Б05-007', 11),
    ('2023-09-27 10:00', '2023-09-27 11:30', 2, 'Никитин Родион Сергеевич', 'Б05-007', 12),
    ('2023-09-28 08:00', '2023-09-28 09:30', 3, 'Васюк Вадим Александрович', 'Б05-007', 3),
    ('2023-10-01 08:00', '2023-10-01 09:30', 4, 'Максимов Михаил Евгеньевич', 'Б05-007', 4),
    ('2023-10-02 08:00', '2023-10-02 09:30', 6, 'Васюк Вадим Александрович', 'Б05-007', 15),
    ('2023-10-02 10:00', '2023-10-02 11:30', 5, 'Павлов Марат Манасович', 'Б05-007', 9),
    ('2023-10-02 12:00', '2023-10-02 13:30', 1, 'Максимов Михаил Евгеньевич', 'Б05-008', 11),
    ('2023-10-03 08:00', '2023-10-03 09:30', 2, 'Никитин Родион Сергеевич', 'Б05-008', 12),
    ('2023-10-03 10:00', '2023-10-03 11:30', 3, 'Васюк Вадим Александрович', 'Б05-008', 13),
    ('2023-10-04 08:00', '2023-10-04 09:30', 4, 'Максимов Михаил Евгеньевич', 'Б05-008', 4),
    ('2023-10-05 08:00', '2023-10-05 09:30', 6, 'Васюк Вадим Александрович', 'Б05-008', 15),
    ('2023-10-07 08:00', '2023-10-07 09:30', 5, 'Павлов Марат Манасович', 'Б05-008', 6)
;
